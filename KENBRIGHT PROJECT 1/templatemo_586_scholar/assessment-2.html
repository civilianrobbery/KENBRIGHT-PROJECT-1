<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css2?family=Gill+Sans+Nova:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <title>Module 2 Assessment | Kenbright IFRS 17 Training</title>
    
    <!-- CSS Files -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-scholar.css">
    <link rel="stylesheet" href="assets/css/modules.css">
    <style>
        /* Apply Gill Sans font to entire page */
        body {
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
            font-weight: 600;
        }
        
        .nav li a {
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .btn, .main-button a {
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }

        /* Simplified header styling */
        .header-area {
            padding: 0 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .main-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px 0;
        }

        /* Ensure navigation items are properly spaced */
        .main-nav .nav {
            display: flex;
            gap: 20px;
            margin: 0;
            padding: 0;
            list-style: none;
        }

        .main-nav .nav li a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }

        .main-nav .nav li a:hover {
            color: #3B82F6;
        }

        /* Search input styling */
        .search-input {
            flex: 1;
            max-width: 400px;
            margin: 0 20px;
            position: relative;
        }

        .search-input input {
            width: 100%;
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }

        .search-input i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
        }

        /* Logo Styles */
        .logo-image {
            height: 130px;
            width: auto;
            max-width: 500px;
        }

        .page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        
        .page-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .assessment-container {
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 30px;
            margin: 30px 0;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .question-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .question-number {
            background: #667eea;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .option-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .option-item:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .option-item.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .option-item.correct {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }
        
        .option-item.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }
        
        .quiz-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .results-container {
            display: none;
            background: #fff;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid #e9ecef;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .score-display {
            font-size: 3rem;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            margin: 20px 0;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }
        
        .progress-summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Gill Sans Nova', 'Gill Sans', sans-serif;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-nav {
                flex-direction: column;
                gap: 15px;
            }
            
            .search-input {
                max-width: 100%;
                margin: 10px 0;
            }
            
            .main-nav .nav {
                gap: 15px;
            }
            
            .logo-image {
                height: 35px;
                max-width: 150px;
            }
        }

        @media (max-width: 480px) {
            .logo-image {
                height: 30px;
                max-width: 130px;
            }
        }
    </style>
</head>

<body>

  <!-- Page Loader -->
  <div class="page-loader" id="pageLoader">
      <div class="loader-content">
          <div class="kenbright-loader">Kenbright</div>
          <div class="loader-spinner"></div>
          <div class="loader-text">Loading Assessment...</div>
      </div>
  </div>

  <!-- Header Area -->
  <header class="header-area header-sticky">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="main-nav">
                    <a href="index.html" class="logo">
                        <img src="assets/images/kenbright-logo.png" alt="Kenbright" class="logo-image">
                    </a>
                    <ul class="nav">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="modules.html">Training Modules</a></li>
                        <li><a href="assessments.html" class="active">Test Assessments</a></li>
                        <li><a href="progress.html">My Progress</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
  </header>

  <!-- Page Banner -->
  <div class="main-banner" id="top">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="header-text">
            <h2>Module 2 Assessment</h2>
            <p>Combination & Separation of Insurance Contracts</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Assessment Container -->
  <section class="section">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          
          <div class="quiz-header">
            <h3><i class="fa fa-question-circle"></i> Module 2 Quiz</h3>
            <p>Test your understanding of Contract Combination & Separation</p>
            <div class="progress" style="height: 8px; background: rgba(255,255,255,0.3);">
              <div class="progress-bar" id="quizProgress" style="width: 0%"></div>
            </div>
            <small id="progressText">Question 1 of 15</small>
          </div>

          <div class="assessment-container">
            <div id="questionsContainer">
              <!-- Questions will be loaded here by JavaScript -->
            </div>
            
            <div class="navigation-buttons">
              <button class="main-button outline" id="prevQuestion" style="display: none;">
                <i class="fa fa-arrow-left"></i> Previous
              </button>
              <button class="main-button" id="submitQuiz" style="display: none;">
                Submit Assessment
              </button>
              <button class="main-button" id="nextQuestion" style="display: none;">
                Next <i class="fa fa-arrow-right"></i>
              </button>
            </div>
          </div>

          <div class="results-container" id="resultsContainer">
            <h3 class="text-center"><i class="fa fa-chart-bar"></i> Assessment Results</h3>
            <div class="score-display" id="finalScore">0/15</div>
            
            <div class="progress-summary">
              <div class="progress" style="height: 20px;">
                <div class="progress-bar" id="scoreProgress" role="progressbar" style="width: 0%"></div>
              </div>
              <div class="progress-text text-center mt-2">
                <span id="scorePercentage">0%</span> - <span id="performanceText">Beginner Level</span>
              </div>
            </div>

            <div id="questionsReview">
              <!-- Questions review will be loaded here -->
            </div>

            <div class="text-center mt-4">
              <button class="main-button outline" onclick="window.location.href='module-2.html'">
                <i class="fa fa-book"></i> Review Module
              </button>
              <button class="main-button" id="nextModuleBtn" onclick="window.location.href='module-3.html'">
                <i class="fa fa-arrow-right"></i> Proceed to Module 3
              </button>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="col-lg-12">
        <p>Copyright Â© <span id="currentYear">2025</span> Kenbright IFRS 17 Training Platform. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  
  <script>
    // Module 2 Questions Data with UPDATED CORRECT answers
    const module2Questions = [
      {
        question: "What is the core principle that governs the combination and separation of contracts under IFRS 17?",
        options: [
          "Legal form over economic substance",
          "The policyholder's intent",
          "Economic substance over legal form",
          "The regulator's classification"
        ],
        correctAnswer: 0, // 1st choice
        explanation: "IFRS 17 mandates that accounting must reflect economic substance rather than merely legal form, ensuring financial reporting portrays the true commercial reality."
      },
      {
        question: "According to IFRS 17, when must two or more contracts be combined and accounted for as a single contract?",
        options: [
          "Only if they are with the same policyholder.",
          "Only if they are for the same type of risk.",
          "If they are entered into at or near the same time and meet at least one of the specified combination criteria.",
          "Always, if they are mentioned in the same policy document."
        ],
        correctAnswer: 1, // 2nd choice
        explanation: "Contracts must be combined if entered into at or near the same time and meet criteria like interdependent pricing, risk neutralization, or unified performance measurement."
      },
      {
        question: "An embedded derivative within an insurance contract must be separated and accounted for under which standard?",
        options: [
          "IFRS 15",
          "IFRS 4", 
          "IFRS 9",
          "IAS 39"
        ],
        correctAnswer: 2, // 3rd choice
        explanation: "Embedded derivatives that are not closely related to the host insurance contract must be separated and accounted for under IFRS 9."
      },
      {
        question: "A distinct investment component that is separated from an insurance contract is accounted for under:",
        options: [
          "IFRS 15",
          "IFRS 4",
          "IFRS 9", 
          "It remains under IFRS 17."
        ],
        correctAnswer: 0, // 1st choice
        explanation: "Distinct investment components are separated and accounted for under IFRS 9, enhancing transparency by separating non-contingent investment flows."
      },
      {
        question: "A distinct non-insurance service, such as a wellness program bundled with a health policy, is separated and accounted for under:",
        options: [
          "IFRS 9",
          "IFRS 15",
          "IAS 37",
          "IFRS 17"
        ],
        correctAnswer: 2, // 3rd choice
        explanation: "Distinct non-insurance services are separated and accounted for under IFRS 15, ensuring proper revenue recognition for services beyond insurance coverage."
      },
      {
        question: "An insurer issues a life insurance contract and a separate, simultaneously issued contract that provides an annuity. The pricing is interdependent, offering a discount if both are purchased together. How should these be accounted for under IFRS 17?",
        options: [
          "Account for them separately as they are legally distinct.",
          "Combine them only if they have the same duration.",
          "Combine them as a single contract because they are priced interdependently to achieve an overall commercial effect.",
          "Account for the life contract under IFRS 17 and the annuity under IFRS 9."
        ],
        correctAnswer: 0, // 1st choice
        explanation: "The contracts should be combined because they are priced interdependently to achieve an overall commercial effect, meeting the combination criteria."
      },
      {
        question: "A single insurance contract includes a death benefit and a savings account that can be surrendered for its cash value independently of a claim being made. The savings account is also sold as a standalone product in the market. How should the savings component be treated?",
        options: [
          "It must remain embedded in the insurance contract.",
          "It should be separated and accounted for under IFRS 15.",
          "It must be separated as a distinct investment component and accounted for under IFRS 9.",
          "It should be ignored as it is part of the insurance coverage."
        ],
        correctAnswer: 2, // 3rd choice
        explanation: "The savings component is distinct (sold separately and not highly interrelated) and must be separated under IFRS 9."
      },
      {
        question: "A property insurance contract includes a clause that adjusts the premium refund based on changes in a specified consumer price index. How should this clause be treated?",
        options: [
          "It is part of the insurance risk and remains under IFRS 17.",
          "It is a non-insurance service and should be separated under IFRS 15.",
          "It is an embedded derivative that must be evaluated for separation under IFRS 9.",
          "It should only be disclosed in the notes to the financial statements."
        ],
        correctAnswer: 3, // 4th choice
        explanation: "The CPI-linked clause is an embedded derivative that modifies cash flows based on a variable not specific to insurance risk, requiring evaluation under IFRS 9."
      },
      {
        question: "Which of the following is a key condition for an investment component to be considered 'distinct' and therefore require separation?",
        options: [
          "It must comprise more than 50% of the total contract premium.",
          "It must be regulated by a financial authority.",
          "A contract with similar terms is sold separately in the same market.",
          "The policyholder must explicitly request its separation."
        ],
        correctAnswer: 3, // 4th choice
        explanation: "An investment component is distinct if a contract with similar terms is sold separately in the same market and it is not highly interrelated with the insurance component."
      },
      {
        question: "Under the IFRS 17 decision-making framework, which step should be performed first?",
        options: [
          "Separation of embedded derivatives.",
          "Separation of investment components.",
          "Assessment of whether separate contracts should be combined.",
          "Application of the Premium Allocation Approach (PAA)."
        ],
        correctAnswer: 1, // 2nd choice
        explanation: "The first step is assessing whether separate contracts should be combined, followed by separation analysis of the resulting contract."
      },
      {
        question: "An insurer issues Contract A (covering fire damage) and Contract B (a specific reinsurance contract that fully offsets the risk from Contract A) to the same counterparty at the same time. For the primary insurer, how should these be accounted for?",
        options: [
          "Present each contract separately as distinct arrangements.",
          "Account for Contract A under IFRS 17 and Contract B under IFRS 9.",
          "Combine the contracts as a single arrangement because one is designed to mitigate the risk of the other (risk neutralization).",
          "Ignore Contract B as it is a reinsurance contract."
        ],
        correctAnswer: 2, // 3rd choice
        explanation: "The contracts should be combined because Contract B is designed to mitigate the risk of Contract A, meeting the risk neutralization criterion."
      },
      {
        question: "A health insurance policy includes 'wellness credits' that policyholders can earn and use to reduce their future premiums. These credits are highly interrelated with the policy's claims experience and cannot be cashed out or used for any other purpose. According to the guidance in Module 2, how should these wellness credits be treated?",
        options: [
          "They are a distinct investment component and must be separated under IFRS 9.",
          "They are a distinct non-insurance service and must be separated under IFRS 15.",
          "They are not distinct and should remain part of the insurance contract accounted for under IFRS 17.",
          "They are an embedded derivative and must be separated under IFRS 9."
        ],
        correctAnswer: 0, // 1st choice
        explanation: "The wellness credits are not distinct because they are highly interrelated with the insurance coverage and cannot be used separately."
      },
      {
        question: "How did the guidance on the separation of embedded derivatives change significantly from IFRS 4 to IFRS 17?",
        options: [
          "Under IFRS 4, separation was mandatory, but under IFRS 17, it is optional.",
          "IFRS 17 prohibits the separation of embedded derivatives that were separated under IFRS 4.",
          "Under IFRS 4, application was inconsistent, but IFRS 17 makes separation mandatory if the derivative is not closely related to the host contract.",
          "There was no significant change; the guidance remained the same."
        ],
        correctAnswer: 3, // 4th choice
        explanation: "IFRS 17 introduces mandatory separation of embedded derivatives that are not closely related, whereas IFRS 4 had inconsistent application."
      },
      {
        question: "A 'rider' attached to a life insurance policy completely cancels the death benefit under the main policy if a specific event occurs. The main policy and the rider are priced as a single package. Under IFRS 17, what is the most appropriate accounting treatment?",
        options: [
          "Account for the main policy and the rider as separate contracts.",
          "Ignore the rider as it does not provide additional coverage.",
          "Combine the main policy and the rider as a single contract because they are interdependent and achieve a unified commercial effect.",
          "Account for the rider under IFRS 15 as a service contract."
        ],
        correctAnswer: 1, // 2nd choice
        explanation: "The rider and main policy should be combined as they are interdependent and achieve a unified commercial effect through their pricing and risk structure."
      },
      {
        question: "The requirement under IFRS 17 to separate distinct investment components into IFRS 9 primarily enhances financial reporting by:",
        options: [
          "Reducing the total liability reported on the balance sheet.",
          "Increasing the complexity of the income statement.",
          "Improving transparency by separating non-contingent investment flows from the insurance liability.",
          "Allowing insurers to avoid discounting the insurance contract liability."
        ],
        correctAnswer: 1, // 2nd choice
        explanation: "Separating distinct investment components enhances transparency by clearly distinguishing insurance risk from investment returns in financial reporting."
      }
    ];

    // Quiz functionality
    let currentQuestion = 0;
    let userAnswers = new Array(module2Questions.length).fill(null);
    let quizSubmitted = false;

    document.addEventListener('DOMContentLoaded', function() {
        const pageLoader = document.getElementById('pageLoader');
        
        // Update copyright year automatically
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        
        setTimeout(() => {
            pageLoader.classList.add('hidden');
            setTimeout(() => {
                pageLoader.remove();
                initializeQuiz();
            }, 500);
        }, 1500);

        // Add event listeners to buttons
        document.getElementById('nextQuestion').addEventListener('click', nextQuestion);
        document.getElementById('prevQuestion').addEventListener('click', prevQuestion);
        document.getElementById('submitQuiz').addEventListener('click', submitQuiz);
    });

    function initializeQuiz() {
        displayQuestion(currentQuestion);
        updateNavigation();
        updateProgress();
    }

    function displayQuestion(questionIndex) {
        const questionsContainer = document.getElementById('questionsContainer');
        const question = module2Questions[questionIndex];
        
        let optionsHtml = '';
        question.options.forEach((option, index) => {
            const isSelected = userAnswers[questionIndex] === index;
            optionsHtml += `
                <div class="option-item ${isSelected ? 'selected' : ''}" onclick="selectOption(${index})">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="question${questionIndex}" 
                               id="option${index}" ${isSelected ? 'checked' : ''}>
                        <label class="form-check-label" for="option${index}">
                            ${option}
                        </label>
                    </div>
                </div>
            `;
        });

        questionsContainer.innerHTML = `
            <div class="question-card">
                <div class="d-flex align-items-start">
                    <div class="question-number">${questionIndex + 1}</div>
                    <div class="flex-grow-1">
                        <h5>${question.question}</h5>
                        <div class="options-container mt-3">
                            ${optionsHtml}
                        </div>
                    </div>
                </div>
            </div>
        `;

        updateNavigation();
    }

    function updateNavigation() {
        const hasAnswer = userAnswers[currentQuestion] !== null;
        const isLastQuestion = currentQuestion === module2Questions.length - 1;
        const isFirstQuestion = currentQuestion === 0;

        // Show/hide previous button
        document.getElementById('prevQuestion').style.display = isFirstQuestion ? 'none' : 'inline-block';
        
        // Show/hide next and submit buttons
        if (isLastQuestion) {
            document.getElementById('nextQuestion').style.display = 'none';
            document.getElementById('submitQuiz').style.display = hasAnswer ? 'inline-block' : 'none';
        } else {
            document.getElementById('nextQuestion').style.display = hasAnswer ? 'inline-block' : 'none';
            document.getElementById('submitQuiz').style.display = 'none';
        }
    }

    function selectOption(optionIndex) {
        userAnswers[currentQuestion] = optionIndex;
        displayQuestion(currentQuestion);
        updateNavigation();
        updateProgress();
    }

    function nextQuestion() {
        if (currentQuestion < module2Questions.length - 1) {
            currentQuestion++;
            displayQuestion(currentQuestion);
            updateNavigation();
            updateProgress();
        }
    }

    function prevQuestion() {
        if (currentQuestion > 0) {
            currentQuestion--;
            displayQuestion(currentQuestion);
            updateNavigation();
            updateProgress();
        }
    }

    function updateProgress() {
        const progress = ((currentQuestion + 1) / module2Questions.length) * 100;
        document.getElementById('quizProgress').style.width = `${progress}%`;
        document.getElementById('progressText').textContent = `Question ${currentQuestion + 1} of ${module2Questions.length}`;
    }

    function submitQuiz() {
        quizSubmitted = true;
        calculateScore();
        showResults();
    }

    function calculateScore() {
        let score = 0;
        module2Questions.forEach((question, index) => {
            if (userAnswers[index] === question.correctAnswer) {
                score++;
            }
        });
        return score;
    }

    function showResults() {
        const score = calculateScore();
        const percentage = (score / module2Questions.length) * 100;
        
        document.getElementById('finalScore').textContent = `${score}/${module2Questions.length}`;
        document.getElementById('scoreProgress').style.width = `${percentage}%`;
        document.getElementById('scorePercentage').textContent = `${percentage.toFixed(1)}%`;
        
        let performanceText = '';
        if (percentage >= 90) performanceText = 'Excellent!';
        else if (percentage >= 80) performanceText = 'Very Good';
        else if (percentage >= 70) performanceText = 'Good';
        else if (percentage >= 60) performanceText = 'Satisfactory';
        else performanceText = 'Needs Improvement';
        
        document.getElementById('performanceText').textContent = performanceText;
        
        // Show questions review
        let reviewHtml = '<h4 class="mt-4">Question Review</h4>';
        module2Questions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer === question.correctAnswer;
            const userAnswerText = userAnswer !== null ? question.options[userAnswer] : 'Not answered';
            const correctAnswerText = question.options[question.correctAnswer];
            
            reviewHtml += `
                <div class="question-card ${isCorrect ? 'border-success' : 'border-danger'}">
                    <div class="d-flex align-items-start">
                        <div class="question-number ${isCorrect ? 'bg-success' : 'bg-danger'}">${index + 1}</div>
                        <div class="flex-grow-1">
                            <h5>${question.question}</h5>
                            <div class="mt-3">
                                <p><strong>Your answer:</strong> 
                                <span class="${isCorrect ? 'text-success' : 'text-danger'}">${userAnswerText}</span></p>
                                ${!isCorrect ? `<p><strong>Correct answer:</strong> 
                                <span class="text-success">${correctAnswerText}</span></p>` : ''}
                                <p><strong>Explanation:</strong> ${question.explanation}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        document.getElementById('questionsReview').innerHTML = reviewHtml;
        document.getElementById('resultsContainer').style.display = 'block';
        
        // Save progress to localStorage
        saveProgress(score, module2Questions.length);
    }

    function saveProgress(score, totalQuestions) {
        const progressData = {
            module: 2,
            score: score,
            totalQuestions: totalQuestions,
            percentage: (score / totalQuestions) * 100,
            completed: true,
            timestamp: new Date().toISOString()
        };
        
        let allProgress = JSON.parse(localStorage.getItem('kenbright_assessment_progress') || '[]');
        allProgress = allProgress.filter(item => item.module !== 2);
        allProgress.push(progressData);
        localStorage.setItem('kenbright_assessment_progress', JSON.stringify(allProgress));
        
        updateModuleCompletion(2);
    }

    function updateModuleCompletion(moduleNumber) {
        let moduleProgress = JSON.parse(localStorage.getItem('kenbright_module_progress') || '{}');
        moduleProgress[`module_${moduleNumber}`] = {
            completed: true,
            completionDate: new Date().toISOString(),
            score: calculateScore()
        };
        localStorage.setItem('kenbright_module_progress', JSON.stringify(moduleProgress));
    }

    // Make functions global for onclick events
    window.selectOption = selectOption;
    window.nextQuestion = nextQuestion;
    window.prevQuestion = prevQuestion;
    window.submitQuiz = submitQuiz;
  </script>
</body>
</html>